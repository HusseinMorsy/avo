<div class="w-full">
  <table class="w-full px-4 overflow-hidden" :class="{'rounded-b-xl': totalPages === 1}">
    <thead v-if="hasFields" class="bg-gray-200 border-t border-b border-gray-500 pb-1">
      <th>
        <!-- Select cell -->
      </th>
      <% fields.each_with_index do |field, index| %>
        <th class="text-left uppercase px-3 py-2">
          <div class="flex items-center text-gray-700 leading-tight text-xs font-semibold<%= 'cursor-pointer' if 'sortable' %>" @click="tryAndSort">
            <%= field[:name] %>
            <%#=
            <component :is="sortComponent"
              v-if="sortable"
              class="inline-block fill-current text-gray-500 relative leading-none min-w-4 min-h-full ml-1 h-4"
            />
             %>
          </div>
        </th>
      <% end %>

      <th class="w-24">
        <!-- Controls cell -->
      </th>
    </thead>
    <tbody>
      <% resources.each_with_index do |resource, index| %>
        <tr
          class="hover:bg-gray-100 hover:shadow-row relative z-20"
          :resource-name="resourceName"
          :resource-id="resource.id"
        >
          <td class="w-10">
            <div class="flex justify-center h-full">
              <input type="checkbox"
                class="mx-3 w-4 h-4"
                @click="updateSelection(resource)"
              />
            </div>
          </td>
          <% resource[:fields].each_with_index do |field, index| %>
            <%= index_field field, index %>
          <% end %>
          <td class="text-right whitespace-no-wrap px-2">
            <div class="flex items-center justify-end flex-grow-0 h-full w-full">
              <%= item_controls resource %>
              <item-controls
                class="flex flex-row"
                :resource="resource"
                :resource-name="resourceName"
                :via-resource-name="viaResourceName"
                :via-resource-id="viaResourceId"
                :field="field"
                @resource-deleted="$emit('resource-deleted')"
              />
            </div>
          </td>
        </tr>
      <% end %>

      <tr
        is="table-row"
        v-for="(resource, index) in resources"
        :class="{'border-b': resources.length - 1 === index ? totalPages > 1 : true}"
        :key="index"
        :resource="resource"
        :resource-name="resourceName"
        :via-resource-name="viaResourceName"
        :via-resource-id="viaResourceId"
        :field="field"
        @resource-deleted="$emit('resource-deleted')"
      />
    </tbody>
  </table>
</div>
